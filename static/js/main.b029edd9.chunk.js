(this["webpackJsonppath-displayer"]=this["webpackJsonppath-displayer"]||[]).push([[0],{24:function(e,t,a){e.exports=a(34)},29:function(e,t,a){},30:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),i=a(10),l=a.n(i),r=(a(29),a(30),a(31),a(3)),o=a(4),c=a(5),u=a(6),h=a(0),m=a(7),d=a(14),p=a(22),g=a(23),S=a(16),f=["Jan.","Feb.","Mar.","Apr.","May","Jun.","Jul.","Aug.","Sept.","Oct.","Nov.","Dec."],v=/(\w+)-([0-9]+)-([0-9]+)_(\w+)\..*/;function y(e){if(!function(e){if(isNaN(e)||e<0)return!1;e=1e3*parseInt(e);var t=new Date(e);return!isNaN(t.getTime())}(e))return"N/A"+(e?" (".concat(e,")"):"");e=1e3*parseInt(e);var t=new Date(e),a=t.getDate(),s=f[t.getMonth()],n=t.getFullYear(),i=t.getHours()%12;0===i&&(i=12);var l="0"+t.getMinutes(),r=t.getHours()>=12?"PM":"AM";return s+" "+a+" "+n+" "+i+":"+l.substr(-2)+" "+r}function b(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(t-e)/60;return a?s.toFixed(2):parseInt(s,10)}var E=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSelectUser=a.handleSelectUser.bind(Object(h.a)(a)),a.handleSelectSession=a.handleSelectSession.bind(Object(h.a)(a)),a.handleSelectRecentSession=a.handleSelectRecentSession.bind(Object(h.a)(a)),a.state={playersLoading:!0,playerSessionsLoading:!1,playerSessionsDisabled:!0,recentSessionsLoading:!0,allPlayers:[],playerSessions:[],recentSessions:[],selectedPlayer:{},selectedPlayerSession:{},selectedRecentSession:{},selectValues:{player:null,playerSession:null,recentSession:null}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;e=function(e){t.setState({allPlayers:e,playersLoading:!1})},fetch("https://pz712697b9.execute-api.us-east-2.amazonaws.com/default/getallusers").then((function(e){return e.json()})).then((function(t){t.sort((function(e,t){var a=e.username.toLowerCase(),s=t.username.toLowerCase();return a.localeCompare(s)}));var a=[];t.forEach((function(e){a.push({value:e.userId,label:e.username})})),e(a)})),function(e){var t="".concat("https://pz712697b9.execute-api.us-east-2.amazonaws.com/default/getrecentsessions","/").concat(20);fetch(t).then((function(e){return e.json()})).then((function(t){var a=[];t.forEach((function(e){var t=b(e.loginTime,e.logoutTime);a.push({value:e.sessionId,label:"".concat(e.username,", ").concat(y(e.loginTime)," (").concat(t," mins)"),userId:e.userId,username:e.username,start_time:e.loginTime,end_time:e.logoutTime})})),e(a)}))}((function(e){t.setState({recentSessions:e,recentSessionsLoading:!1})}))}},{key:"handleSelectUser",value:function(e){var t=this,a={player:e,playerSession:null,recentSession:null};this.setState({selectedPlayer:e,selectedPlayerSession:null,selectValues:a},(function(){t.props.sessionChange(null),t.generateUserSessions()}))}},{key:"generateUserSessions",value:function(){var e=this;this.state.selectedPlayer?this.setState({playerSessionsLoading:!0,playerSessionsDisabled:!0},(function(){!function(e,t){var a="".concat("https://pz712697b9.execute-api.us-east-2.amazonaws.com/default/getsessions","/").concat(e);fetch(a).then((function(e){return e.json()})).then((function(e){var a=[];e.forEach((function(e){var t=b(e.loginTime,e.logoutTime);a.push({value:e.sessionId,label:"".concat(y(e.loginTime)," (").concat(t," mins)"),userId:e.userId,start_time:e.loginTime,end_time:e.logoutTime})})),a.reverse(),t(a)}))}(e.state.selectedPlayer.value,(function(t){e.setState({playerSessions:t,playerSessionsLoading:!1,playerSessionsDisabled:!1})}))})):this.setState({playerSessionsDisabled:!0})}},{key:"handleSelectSession",value:function(e){var t=this,a=this.state.selectValues;a.playerSession=e;var s={username:a.player.label,start_time:e.start_time,end_time:e.end_time};this.setState({selectedPlayerSession:e,selectValue:a},(function(){t.props.sessionChange(s)}))}},{key:"handleSelectRecentSession",value:function(e){var t=this,a={player:null,playerSession:null,recentSession:e};this.setState({playerSessionsDisabled:!0,selectedPlayer:null,selectedPlayerSession:null,selectedRecentSession:e,selectValues:a},(function(){t.props.sessionChange(e)}))}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("p",{className:"text-left m-0 p-0"},n.a.createElement("b",null,"Select a user and a session:")),n.a.createElement(S.a,{className:"Custom-select mb-1",placeholder:"Select a user",options:this.state.allPlayers,isClearable:!0,value:this.state.selectValues.player,isLoading:this.state.playersLoading,isDisabled:this.state.playersLoading,onChange:this.handleSelectUser}),n.a.createElement(S.a,{className:"Custom-select mb-4",placeholder:"Select a session",options:this.state.playerSessions,isClearable:!0,value:this.state.selectValues.playerSession,isLoading:this.state.playerSessionsLoading,isDisabled:this.state.playerSessionsDisabled,onChange:this.handleSelectSession}),n.a.createElement("p",{className:"text-left m-0 p-0"},n.a.createElement("b",null,"Choose from the 20 most recent sessions:")),n.a.createElement(S.a,{className:"Custom-select",placeholder:"Select a recent session",options:this.state.recentSessions,isClearable:!0,value:this.state.selectValues.recentSession,isLoading:this.state.recentSessionsLoading,isDisabled:this.state.recentSessionsLoading,onChange:this.handleSelectRecentSession}))}}]),t}(n.a.Component),k=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.title.match(v)[4];return n.a.createElement(d.a,{variant:"primary"},n.a.createElement(d.a.Heading,null,e),n.a.createElement("a",{href:this.props.link,target:"_blank",rel:"noopener noreferrer"},n.a.createElement("img",{width:"100%",src:this.props.link,alt:this.props.title})))}}]),t}(n.a.Component),C=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).generateButtonClick=a.generateButtonClick.bind(Object(h.a)(a)),a.handleSessionChange=a.handleSessionChange.bind(Object(h.a)(a)),a.state={loading:!1,session:null,images:null,generatedSession:null},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleSessionChange",value:function(e){this.setState({session:e})}},{key:"generateButtonClick",value:function(){var e=this;this.setState({loading:!0,images:null,generatedSession:this.state.session},(function(){!function(e,t,a,s){var n="".concat("https://whimc-api.education.illinois.edu/path-generator/api","?username=").concat(e,"&start_time=").concat(t,"&end_time=").concat(a);fetch(n).then((function(e){return e.json()})).then((function(e){var t=[];Object.keys(e.links).forEach((function(a){t.push({title:a,link:e.links[a]})})),s(t)})).catch((function(e){s([])}))}(e.state.session.username,e.state.session.start_time,e.state.session.end_time,(function(t){e.setState({images:t,loading:!1})}))}))}},{key:"render",value:function(){var e=null;this.state.loading&&(e=n.a.createElement("div",null,n.a.createElement(p.a,{animation:"border",role:"status"},n.a.createElement("span",{className:"sr-only"},"Loading...")),n.a.createElement("p",null,"This may take a moment.")));var t=null;return null!==this.state.images&&(0===this.state.images.length?t=n.a.createElement("div",{className:"Path-displayer"},n.a.createElement(d.a,{variant:"danger"},this.state.generatedSession.username," did not explore any maps during this session!")):(t=this.state.images.map((function(e,t){return n.a.createElement(k,{key:e.link,link:e.link,title:e.title})})),t=n.a.createElement("div",null,n.a.createElement("div",{className:"Path-displayer"},n.a.createElement(d.a,{variant:"success"},this.state.generatedSession.username," explored ",this.state.images.length," map(s)!")),n.a.createElement("div",{className:"Path-images"},t)))),n.a.createElement("div",{id:"parent"},n.a.createElement("div",{className:"Path-displayer",id:"input"},n.a.createElement(d.a,{variant:"primary"},n.a.createElement(d.a.Heading,null,"Welcome to the WHIMC Path Displayer!"),n.a.createElement("hr",null),n.a.createElement(E,{sessionChange:this.handleSessionChange}),n.a.createElement("hr",null),n.a.createElement(g.a,{variant:"primary",disabled:null===this.state.session||this.state.loading,onClick:this.generateButtonClick},"Generate Images")),e),t)}}]),t}(n.a.Component);var j=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},n.a.createElement(C,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[24,1,2]]]);
//# sourceMappingURL=main.b029edd9.chunk.js.map